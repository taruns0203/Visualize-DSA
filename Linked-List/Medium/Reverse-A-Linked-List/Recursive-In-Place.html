<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Recursive In-Place Reversal - Whiteboard</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;600;700&family=Patrick+Hand&display=swap"
      rel="stylesheet"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Caveat", cursive;
        background: #f5f5f0;
        min-height: 100vh;
        padding: 20px;
      }

      .whiteboard {
        max-width: 1200px;
        margin: 0 auto;
        background: #ffffff;
        border-radius: 8px;
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1),
          inset 0 0 100px rgba(200, 200, 200, 0.1);
        padding: 40px 50px;
        position: relative;
        overflow: hidden;
      }

      .whiteboard::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-image: linear-gradient(
            rgba(0, 0, 0, 0.02) 1px,
            transparent 1px
          ),
          linear-gradient(90deg, rgba(0, 0, 0, 0.02) 1px, transparent 1px);
        background-size: 25px 25px;
        pointer-events: none;
      }

      .title {
        font-size: 42px;
        font-weight: 700;
        color: #2c3e50;
        text-align: center;
        margin-bottom: 10px;
        text-decoration: underline;
        text-decoration-style: wavy;
        text-decoration-color: #9c27b0;
        text-underline-offset: 8px;
      }

      .subtitle {
        font-family: "Patrick Hand", cursive;
        font-size: 22px;
        color: #7f8c8d;
        text-align: center;
        margin-bottom: 20px;
      }

      /* Algorithm box */
      .algorithm-box {
        background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
        border: 2px solid #9c27b0;
        border-radius: 12px;
        padding: 20px 25px;
        margin-bottom: 35px;
        font-family: "Courier New", monospace;
        font-size: 15px;
        line-height: 1.6;
      }

      .algorithm-title {
        font-family: "Caveat", cursive;
        font-size: 26px;
        color: #6a1b9a;
        margin-bottom: 15px;
        border-bottom: 2px dashed #ce93d8;
        padding-bottom: 8px;
      }

      .code-line {
        margin: 4px 0;
        padding: 3px 10px;
        border-radius: 4px;
      }

      .code-highlight {
        background: #fff3cd;
        border-left: 3px solid #ffc107;
      }

      .code-comment {
        color: #6a9955;
        font-style: italic;
      }

      /* Key concept boxes */
      .concept-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      .concept-box {
        padding: 20px;
        border-radius: 12px;
        border: 3px solid;
      }

      .concept-dive {
        background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
        border-color: #1976d2;
      }

      .concept-bubble {
        background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
        border-color: #f57c00;
      }

      .concept-title {
        font-size: 24px;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .concept-text {
        font-family: "Patrick Hand", cursive;
        font-size: 18px;
        color: #555;
      }

      /* Call stack visualization */
      .call-stack-container {
        display: flex;
        gap: 30px;
        margin: 30px 0;
      }

      .call-stack {
        display: flex;
        flex-direction: column;
        gap: 5px;
        min-width: 200px;
      }

      .stack-title {
        font-size: 22px;
        text-align: center;
        margin-bottom: 10px;
        padding-bottom: 10px;
        border-bottom: 2px dashed #ccc;
      }

      .stack-frame {
        padding: 12px 15px;
        border-radius: 8px;
        font-family: "Courier New", monospace;
        font-size: 14px;
        border: 2px solid;
        position: relative;
        transition: all 0.3s ease;
      }

      .frame-active {
        background: #fff3cd;
        border-color: #ffc107;
        box-shadow: 0 0 10px rgba(255, 193, 7, 0.5);
      }

      .frame-waiting {
        background: #e3f2fd;
        border-color: #90caf9;
        opacity: 0.7;
      }

      .frame-done {
        background: #c8e6c9;
        border-color: #66bb6a;
      }

      .frame-base {
        background: #f3e5f5;
        border-color: #ba68c8;
      }

      /* Phase indicators */
      .phase-section {
        margin: 40px 0;
        padding: 30px;
        border-radius: 15px;
        border: 3px solid;
      }

      .phase-dive {
        background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
        border-color: #4caf50;
      }

      .phase-bubble {
        background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
        border-color: #ff9800;
      }

      .phase-title {
        font-size: 32px;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .phase-badge {
        padding: 8px 20px;
        border-radius: 25px;
        font-size: 18px;
        color: white;
      }

      .badge-dive {
        background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
      }

      .badge-bubble {
        background: linear-gradient(135deg, #f57c00 0%, #ef6c00 100%);
      }

      /* Step styling */
      .step {
        margin-bottom: 40px;
        padding: 25px;
        background: white;
        border-radius: 12px;
        border-left: 5px solid;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .step-dive {
        border-color: #1976d2;
      }

      .step-bubble {
        border-color: #f57c00;
      }

      .step-base {
        border-color: #9c27b0;
        background: linear-gradient(135deg, #fce4ec 0%, #f8bbd9 100%);
      }

      .step-header {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-bottom: 15px;
      }

      .step-number {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: 700;
        color: white;
      }

      .step-number-dive {
        background: linear-gradient(135deg, #1976d2 0%, #1565c0 100%);
      }

      .step-number-bubble {
        background: linear-gradient(135deg, #f57c00 0%, #ef6c00 100%);
      }

      .step-number-base {
        background: linear-gradient(135deg, #9c27b0 0%, #7b1fa2 100%);
      }

      .step-title {
        font-size: 24px;
        color: #2c3e50;
      }

      .step-description {
        font-family: "Patrick Hand", cursive;
        font-size: 18px;
        color: #555;
        margin-bottom: 15px;
      }

      /* Linked list visualization */
      .visualization {
        padding: 25px;
        background: #fafafa;
        border-radius: 10px;
        border: 2px solid #e0e0e0;
      }

      .list-row {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        flex-wrap: wrap;
        margin: 15px 0;
      }

      .node {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .node-box {
        display: flex;
        border: 3px solid #2c3e50;
        border-radius: 8px;
        overflow: hidden;
        background: white;
        box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.1);
      }

      .node-value {
        padding: 12px 18px;
        font-size: 26px;
        font-weight: 700;
        color: #2c3e50;
        border-right: 2px solid #2c3e50;
        min-width: 45px;
        text-align: center;
      }

      .node-pointer {
        padding: 12px 12px;
        font-size: 18px;
        color: #7f8c8d;
      }

      .node-reversed {
        border-color: #27ae60 !important;
        background: #d4edda !important;
      }

      .node-reversed .node-value {
        color: #155724;
        border-color: #27ae60;
      }

      .node-current {
        border-color: #9c27b0 !important;
        box-shadow: 0 0 0 4px rgba(156, 39, 176, 0.3),
          3px 3px 0 rgba(0, 0, 0, 0.1);
      }

      .node-head {
        border-color: #1976d2 !important;
      }

      .node-faded {
        opacity: 0.4;
      }

      .arrow {
        font-size: 28px;
        color: #2c3e50;
        margin: 0 5px;
      }

      .arrow-reversed {
        color: #27ae60;
      }

      .arrow-new {
        color: #e91e63;
        font-weight: bold;
      }

      .null-box {
        padding: 10px 15px;
        font-size: 20px;
        font-weight: 600;
        color: #95a5a6;
        border: 3px dashed #bdc3c7;
        border-radius: 8px;
        background: #ecf0f1;
      }

      .node-label {
        font-family: "Patrick Hand", cursive;
        font-size: 14px;
        margin-top: 5px;
        padding: 3px 10px;
        border-radius: 10px;
      }

      .label-head {
        background: #e3f2fd;
        color: #1565c0;
        border: 1px solid #90caf9;
      }

      .label-newhead {
        background: #c8e6c9;
        color: #2e7d32;
        border: 1px solid #81c784;
      }

      /* Action boxes */
      .action-box {
        display: inline-block;
        padding: 10px 20px;
        border-radius: 8px;
        font-family: "Courier New", monospace;
        font-size: 15px;
        margin: 10px 5px;
      }

      .action-call {
        background: #e3f2fd;
        border: 2px solid #1976d2;
        color: #0d47a1;
      }

      .action-return {
        background: #fff3e0;
        border: 2px solid #f57c00;
        color: #e65100;
      }

      .action-reverse {
        background: #fce4ec;
        border: 2px solid #e91e63;
        color: #880e4f;
      }

      /* Annotations */
      .annotation {
        font-family: "Caveat", cursive;
        font-size: 18px;
        color: #e91e63;
        padding: 8px 15px;
        background: #fce4ec;
        border: 2px solid #f8bbd9;
        border-radius: 8px;
        display: inline-block;
        transform: rotate(-1deg);
        margin: 10px 0;
      }

      /* Key insight */
      .key-insight {
        background: linear-gradient(135deg, #fff9c4 0%, #fff59d 100%);
        border: 3px solid #fbc02d;
        border-radius: 12px;
        padding: 20px;
        margin: 25px 0;
        position: relative;
      }

      .key-insight::before {
        content: "üí°";
        position: absolute;
        top: -15px;
        left: 20px;
        font-size: 28px;
        background: white;
        padding: 0 10px;
        border-radius: 50%;
      }

      .key-insight-title {
        font-size: 22px;
        color: #f57f17;
        margin-bottom: 10px;
        padding-top: 5px;
      }

      .key-insight-text {
        font-family: "Patrick Hand", cursive;
        font-size: 18px;
        color: #555;
      }

      /* Pointer reversal detail */
      .reversal-detail {
        background: white;
        padding: 20px;
        border-radius: 10px;
        margin: 15px 0;
        border: 2px solid #e91e63;
      }

      .reversal-title {
        font-size: 20px;
        color: #c2185b;
        margin-bottom: 15px;
      }

      .reversal-step {
        display: flex;
        align-items: center;
        gap: 15px;
        margin: 10px 0;
        font-family: "Patrick Hand", cursive;
        font-size: 18px;
      }

      .reversal-icon {
        font-size: 24px;
      }

      .reversal-code {
        font-family: "Courier New", monospace;
        background: #f5f5f5;
        padding: 5px 12px;
        border-radius: 5px;
        font-size: 14px;
      }

      /* Final result */
      .final-result {
        background: linear-gradient(135deg, #c8e6c9 0%, #a5d6a7 100%);
        border: 3px solid #4caf50;
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        margin-top: 30px;
      }

      .final-title {
        font-size: 32px;
        color: #1b5e20;
        margin-bottom: 20px;
      }

      /* Complexity comparison */
      .complexity-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-top: 25px;
      }

      .complexity-box {
        padding: 20px;
        border-radius: 10px;
        text-align: center;
      }

      .complexity-good {
        background: #c8e6c9;
        border: 2px solid #4caf50;
      }

      .complexity-warn {
        background: #fff3e0;
        border: 2px solid #ff9800;
      }

      .complexity-title {
        font-size: 20px;
        margin-bottom: 8px;
      }

      .complexity-value {
        font-family: "Courier New", monospace;
        font-size: 28px;
        font-weight: bold;
      }

      /* Visual separator */
      .visual-separator {
        height: 3px;
        background: linear-gradient(90deg, transparent, #ce93d8, transparent);
        margin: 30px 0;
      }

      /* Recursion tree mini */
      .recursion-tree {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 10px;
        padding: 20px;
        background: white;
        border-radius: 10px;
        border: 2px solid #e0e0e0;
      }

      .tree-level {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .tree-node {
        padding: 8px 15px;
        border-radius: 20px;
        font-size: 16px;
        font-weight: 600;
      }

      .tree-arrow {
        font-size: 20px;
        color: #9e9e9e;
      }
    </style>
  </head>
  <body>
    <div class="whiteboard">
      <h1 class="title">Recursive In-Place Reversal</h1>
      <p class="subtitle">
        Input: head = [1, 2, 3, 4, 5] ‚Üí Output: [5, 4, 3, 2, 1]
      </p>
      <p class="subtitle" style="color: #9c27b0; font-size: 24px">
        üîÑ The Elegant Recursive Solution üîÑ
      </p>

      <!-- Algorithm pseudocode -->
      <div class="algorithm-box">
        <div class="algorithm-title">üìù The Recursive Algorithm</div>
        <div class="code-line code-highlight">function reverseList(head):</div>
        <div class="code-line" style="margin-left: 20px">
          <span class="code-comment">// Base case: empty or single node</span>
        </div>
        <div class="code-line code-highlight" style="margin-left: 20px">
          if head == null OR head.next == null:
        </div>
        <div class="code-line" style="margin-left: 40px">return head</div>
        <div class="code-line" style="margin-left: 20px"></div>
        <div class="code-line" style="margin-left: 20px">
          <span class="code-comment"
            >// Recursive call - reverse the rest first!</span
          >
        </div>
        <div class="code-line code-highlight" style="margin-left: 20px">
          newHead = reverseList(head.next)
        </div>
        <div class="code-line" style="margin-left: 20px"></div>
        <div class="code-line" style="margin-left: 20px">
          <span class="code-comment"
            >// The magic: make next node point back to us</span
          >
        </div>
        <div class="code-line code-highlight" style="margin-left: 20px">
          head.next.next = head
        </div>
        <div class="code-line" style="margin-left: 20px">
          <span class="code-comment">// We become the new tail</span>
        </div>
        <div class="code-line code-highlight" style="margin-left: 20px">
          head.next = null
        </div>
        <div class="code-line" style="margin-left: 20px"></div>
        <div class="code-line" style="margin-left: 20px">return newHead</div>
      </div>

      <!-- Two-phase concept -->
      <div class="concept-grid">
        <div class="concept-box concept-dive">
          <div class="concept-title" style="color: #1565c0">
            <span style="font-size: 30px">‚¨áÔ∏è</span> Phase 1: DIVE DOWN
          </div>
          <div class="concept-text">
            Keep calling reverseList(head.next) until we reach the last node.
            Each call waits for the next one to return.
            <br /><br />
            <strong>No work done yet!</strong> Just building up the call stack.
          </div>
        </div>
        <div class="concept-box concept-bubble">
          <div class="concept-title" style="color: #e65100">
            <span style="font-size: 30px">‚¨ÜÔ∏è</span> Phase 2: BUBBLE UP
          </div>
          <div class="concept-text">
            As each call returns, we reverse ONE pointer.
            <br /><br />
            <code>head.next.next = head</code> makes the next node point back to
            us! <br /><br />
            <strong>This is where the magic happens!</strong>
          </div>
        </div>
      </div>

      <!-- Key Insight -->
      <div class="key-insight">
        <div class="key-insight-title">The Core Trick</div>
        <div class="key-insight-text">
          <code>head.next.next = head</code> looks confusing, but think of it
          this way:<br /><br />
          ‚Ä¢ <code>head.next</code> = the node AFTER current (let's call it
          "B")<br />
          ‚Ä¢ <code>head.next.next</code> = B's next pointer (where B points
          to)<br />
          ‚Ä¢ <code>head.next.next = head</code> = Make B point BACK to
          current!<br /><br />
          So if we have <code>A ‚Üí B</code>, this becomes <code>A ‚Üê B</code>
        </div>
      </div>

      <div class="visual-separator"></div>

      <!-- ==================== PHASE 1: DIVING DOWN ==================== -->
      <div class="phase-section phase-dive">
        <div class="phase-title">
          <span class="phase-badge badge-dive">PHASE 1</span>
          <span style="color: #1565c0"
            >‚¨áÔ∏è Diving Down (Building Call Stack)</span
          >
        </div>

        <!-- Call 1 -->
        <div class="step step-dive">
          <div class="step-header">
            <div class="step-number step-number-dive">1</div>
            <div class="step-title">reverseList(1) - Start!</div>
          </div>
          <div class="step-description">
            head = Node(1). Is head null? No. Is head.next null? No (it's Node
            2).
            <br />So we must recurse! Call reverseList(head.next)...
          </div>
          <div class="action-box action-call">üìû Call: reverseList(2)</div>
          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-current">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="null-box">null</div>
            </div>
          </div>
          <div class="annotation">
            ‚è∏Ô∏è Waiting for reverseList(2) to return...
          </div>
        </div>

        <!-- Call 2 -->
        <div class="step step-dive">
          <div class="step-header">
            <div class="step-number step-number-dive">2</div>
            <div class="step-title">reverseList(2)</div>
          </div>
          <div class="step-description">
            head = Node(2). Is head.next null? No (it's Node 3). Recurse!
          </div>
          <div class="action-box action-call">üìû Call: reverseList(3)</div>
          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-current">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="null-box">null</div>
            </div>
          </div>
          <div class="annotation">
            ‚è∏Ô∏è Waiting for reverseList(3) to return...
          </div>
        </div>

        <!-- Call 3 -->
        <div class="step step-dive">
          <div class="step-header">
            <div class="step-number step-number-dive">3</div>
            <div class="step-title">reverseList(3)</div>
          </div>
          <div class="step-description">
            head = Node(3). Is head.next null? No (it's Node 4). Recurse!
          </div>
          <div class="action-box action-call">üìû Call: reverseList(4)</div>
          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-current">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="null-box">null</div>
            </div>
          </div>
          <div class="annotation">
            ‚è∏Ô∏è Waiting for reverseList(4) to return...
          </div>
        </div>

        <!-- Call 4 -->
        <div class="step step-dive">
          <div class="step-header">
            <div class="step-number step-number-dive">4</div>
            <div class="step-title">reverseList(4)</div>
          </div>
          <div class="step-description">
            head = Node(4). Is head.next null? No (it's Node 5). Recurse!
          </div>
          <div class="action-box action-call">üìû Call: reverseList(5)</div>
          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-current">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="node">
                <div class="node-box">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="null-box">null</div>
            </div>
          </div>
          <div class="annotation">
            ‚è∏Ô∏è Waiting for reverseList(5) to return...
          </div>
        </div>

        <!-- Call 5 - BASE CASE -->
        <div class="step step-base">
          <div class="step-header">
            <div class="step-number step-number-base">5</div>
            <div class="step-title">reverseList(5) - üéØ BASE CASE!</div>
          </div>
          <div class="step-description">
            head = Node(5). Is head.next null?
            <strong style="color: #9c27b0">YES!</strong> <br />This is the last
            node - it becomes the new head of the reversed list!
          </div>
          <div class="action-box action-return">
            üîô Return: Node(5) as newHead
          </div>
          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-reversed" style="border-width: 4px">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-newhead">newHead! üéâ</span>
              </div>
              <span class="arrow">‚Üí</span>
              <div class="null-box">null</div>
            </div>
          </div>
          <div
            class="annotation"
            style="background: #e8f5e9; border-color: #a5d6a7; color: #2e7d32"
          >
            ‚úÖ Base case reached! Node 5 will be the new head of our reversed
            list!
          </div>
        </div>

        <!-- Call Stack at Base Case -->
        <div class="visualization" style="margin-top: 20px">
          <div style="text-align: center; font-size: 22px; margin-bottom: 15px">
            üìö Call Stack at Base Case
          </div>
          <div class="recursion-tree">
            <div class="tree-level">
              <span
                class="tree-node"
                style="background: #e3f2fd; border: 2px solid #1976d2"
                >reverseList(1)</span
              >
              <span class="tree-arrow">‚è∏Ô∏è waiting</span>
            </div>
            <div class="tree-level">
              <span style="margin-left: 30px">‚Ü≥</span>
              <span
                class="tree-node"
                style="background: #e3f2fd; border: 2px solid #1976d2"
                >reverseList(2)</span
              >
              <span class="tree-arrow">‚è∏Ô∏è waiting</span>
            </div>
            <div class="tree-level">
              <span style="margin-left: 60px">‚Ü≥</span>
              <span
                class="tree-node"
                style="background: #e3f2fd; border: 2px solid #1976d2"
                >reverseList(3)</span
              >
              <span class="tree-arrow">‚è∏Ô∏è waiting</span>
            </div>
            <div class="tree-level">
              <span style="margin-left: 90px">‚Ü≥</span>
              <span
                class="tree-node"
                style="background: #e3f2fd; border: 2px solid #1976d2"
                >reverseList(4)</span
              >
              <span class="tree-arrow">‚è∏Ô∏è waiting</span>
            </div>
            <div class="tree-level">
              <span style="margin-left: 120px">‚Ü≥</span>
              <span
                class="tree-node"
                style="background: #f3e5f5; border: 2px solid #9c27b0"
                >reverseList(5)</span
              >
              <span class="tree-arrow">üéØ BASE CASE - returns 5</span>
            </div>
          </div>
        </div>
      </div>

      <div class="visual-separator"></div>

      <!-- ==================== PHASE 2: BUBBLING UP ==================== -->
      <div class="phase-section phase-bubble">
        <div class="phase-title">
          <span class="phase-badge badge-bubble">PHASE 2</span>
          <span style="color: #e65100"
            >‚¨ÜÔ∏è Bubbling Up (Reversing Pointers!)</span
          >
        </div>

        <!-- Return to Call 4 -->
        <div class="step step-bubble">
          <div class="step-header">
            <div class="step-number step-number-bubble">4</div>
            <div class="step-title">Back to reverseList(4) - Reverse 4‚Üî5!</div>
          </div>
          <div class="step-description">
            We're back! newHead = Node(5). Now we do the magic:
          </div>

          <div class="reversal-detail">
            <div class="reversal-title">üîÑ Pointer Reversal Steps:</div>
            <div class="reversal-step">
              <span class="reversal-icon">1Ô∏è‚É£</span>
              <span class="reversal-code">head.next.next = head</span>
              <span>‚Üí Node(4).next.next = Node(4)</span>
              <span>‚Üí Node(5).next = Node(4)</span>
              <span style="color: #e91e63; font-weight: bold"
                >// 5 now points to 4!</span
              >
            </div>
            <div class="reversal-step">
              <span class="reversal-icon">2Ô∏è‚É£</span>
              <span class="reversal-code">head.next = null</span>
              <span>‚Üí Node(4).next = null</span>
              <span style="color: #e91e63; font-weight: bold"
                >// 4 becomes temporary tail</span
              >
            </div>
          </div>

          <div class="visualization">
            <p
              style="
                text-align: center;
                font-family: 'Patrick Hand', cursive;
                font-size: 18px;
                margin-bottom: 10px;
              "
            >
              Before: 4 ‚Üí 5 ‚Üí null | After: null ‚Üê 4 ‚Üê 5
            </p>
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed" style="border-width: 4px">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-newhead">newHead</span>
              </div>
            </div>
            <p style="text-align: center; margin-top: 10px">
              <span class="action-box action-return">üîô Return: Node(5)</span>
            </p>
          </div>
        </div>

        <!-- Return to Call 3 -->
        <div class="step step-bubble">
          <div class="step-header">
            <div class="step-number step-number-bubble">3</div>
            <div class="step-title">Back to reverseList(3) - Reverse 3‚Üî4!</div>
          </div>
          <div class="step-description">
            newHead = Node(5) (unchanged!). Now reverse 3 and 4:
          </div>

          <div class="reversal-detail">
            <div class="reversal-title">üîÑ Pointer Reversal:</div>
            <div class="reversal-step">
              <span class="reversal-icon">1Ô∏è‚É£</span>
              <span class="reversal-code">head.next.next = head</span>
              <span>‚Üí Node(4).next = Node(3)</span>
              <span style="color: #e91e63">// 4 now points to 3!</span>
            </div>
            <div class="reversal-step">
              <span class="reversal-icon">2Ô∏è‚É£</span>
              <span class="reversal-code">head.next = null</span>
              <span>‚Üí Node(3).next = null</span>
            </div>
          </div>

          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed" style="border-width: 4px">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-newhead">newHead</span>
              </div>
            </div>
            <p style="text-align: center; margin-top: 10px">
              <span class="action-box action-return">üîô Return: Node(5)</span>
            </p>
          </div>
          <div class="annotation">Reversed portion: null ‚Üê 3 ‚Üê 4 ‚Üê 5</div>
        </div>

        <!-- Return to Call 2 -->
        <div class="step step-bubble">
          <div class="step-header">
            <div class="step-number step-number-bubble">2</div>
            <div class="step-title">Back to reverseList(2) - Reverse 2‚Üî3!</div>
          </div>
          <div class="step-description">
            newHead = Node(5). Reverse 2 and 3:
          </div>

          <div class="reversal-detail">
            <div class="reversal-title">üîÑ Pointer Reversal:</div>
            <div class="reversal-step">
              <span class="reversal-icon">1Ô∏è‚É£</span>
              <span class="reversal-code">head.next.next = head</span>
              <span>‚Üí Node(3).next = Node(2)</span>
            </div>
            <div class="reversal-step">
              <span class="reversal-icon">2Ô∏è‚É£</span>
              <span class="reversal-code">head.next = null</span>
              <span>‚Üí Node(2).next = null</span>
            </div>
          </div>

          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-faded">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow" style="opacity: 0.4">‚Üí</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head</span>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed" style="border-width: 4px">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-newhead">newHead</span>
              </div>
            </div>
            <p style="text-align: center; margin-top: 10px">
              <span class="action-box action-return">üîô Return: Node(5)</span>
            </p>
          </div>
          <div class="annotation">Reversed portion: null ‚Üê 2 ‚Üê 3 ‚Üê 4 ‚Üê 5</div>
        </div>

        <!-- Return to Call 1 -->
        <div class="step step-bubble">
          <div class="step-header">
            <div class="step-number step-number-bubble">1</div>
            <div class="step-title">
              Back to reverseList(1) - Reverse 1‚Üî2! (Final!)
            </div>
          </div>
          <div class="step-description">
            newHead = Node(5). Last reversal - 1 and 2:
          </div>

          <div class="reversal-detail">
            <div class="reversal-title">üîÑ Final Pointer Reversal:</div>
            <div class="reversal-step">
              <span class="reversal-icon">1Ô∏è‚É£</span>
              <span class="reversal-code">head.next.next = head</span>
              <span>‚Üí Node(2).next = Node(1)</span>
              <span style="color: #e91e63">// 2 now points to 1!</span>
            </div>
            <div class="reversal-step">
              <span class="reversal-icon">2Ô∏è‚É£</span>
              <span class="reversal-code">head.next = null</span>
              <span>‚Üí Node(1).next = null</span>
              <span style="color: #e91e63">// 1 is now the tail!</span>
            </div>
          </div>

          <div class="visualization">
            <div class="list-row">
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">1</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-head">head (now tail!)</span>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">2</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">3</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed">
                  <div class="node-value">4</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
              </div>
              <span class="arrow arrow-reversed">‚Üê</span>
              <div class="node">
                <div class="node-box node-reversed" style="border-width: 4px">
                  <div class="node-value">5</div>
                  <div class="node-pointer">‚Ä¢</div>
                </div>
                <span class="node-label label-newhead">newHead</span>
              </div>
            </div>
            <p style="text-align: center; margin-top: 10px">
              <span class="action-box action-return" style="font-size: 18px"
                >üîô Return: Node(5) to caller! üéâ</span
              >
            </p>
          </div>
        </div>
      </div>

      <div class="visual-separator"></div>

      <!-- FINAL RESULT -->
      <div class="final-result">
        <div class="final-title">üéâ Recursion Complete - List Reversed!</div>

        <div
          class="visualization"
          style="background: white; border-color: #4caf50"
        >
          <p
            style="
              font-family: 'Patrick Hand', cursive;
              font-size: 22px;
              margin-bottom: 20px;
            "
          >
            <strong>Original:</strong> 1 ‚Üí 2 ‚Üí 3 ‚Üí 4 ‚Üí 5 ‚Üí null
          </p>

          <div class="list-row">
            <div class="node">
              <div class="node-box node-reversed" style="border-width: 4px">
                <div class="node-value">5</div>
                <div class="node-pointer">‚Ä¢</div>
              </div>
              <span class="node-label label-newhead">NEW HEAD</span>
            </div>
            <span class="arrow arrow-reversed">‚Üí</span>
            <div class="node">
              <div class="node-box node-reversed">
                <div class="node-value">4</div>
                <div class="node-pointer">‚Ä¢</div>
              </div>
            </div>
            <span class="arrow arrow-reversed">‚Üí</span>
            <div class="node">
              <div class="node-box node-reversed">
                <div class="node-value">3</div>
                <div class="node-pointer">‚Ä¢</div>
              </div>
            </div>
            <span class="arrow arrow-reversed">‚Üí</span>
            <div class="node">
              <div class="node-box node-reversed">
                <div class="node-value">2</div>
                <div class="node-pointer">‚Ä¢</div>
              </div>
            </div>
            <span class="arrow arrow-reversed">‚Üí</span>
            <div class="node">
              <div class="node-box node-reversed">
                <div class="node-value">1</div>
                <div class="node-pointer">‚Ä¢</div>
              </div>
            </div>
            <span class="arrow arrow-reversed">‚Üí</span>
            <div class="null-box" style="border-color: #4caf50">null</div>
          </div>

          <p
            style="
              font-family: 'Patrick Hand', cursive;
              font-size: 24px;
              margin-top: 20px;
              color: #1b5e20;
            "
          >
            <strong>Output:</strong> [5, 4, 3, 2, 1] ‚úì
          </p>
        </div>

        <div class="complexity-grid">
          <div class="complexity-box complexity-good">
            <div class="complexity-title" style="color: #1b5e20">
              ‚è±Ô∏è Time Complexity
            </div>
            <div class="complexity-value" style="color: #4caf50">O(n)</div>
            <p
              style="
                font-family: 'Patrick Hand', cursive;
                font-size: 16px;
                margin-top: 10px;
              "
            >
              Visit each node once (n recursive calls)
            </p>
          </div>
          <div class="complexity-box complexity-warn">
            <div class="complexity-title" style="color: #e65100">
              üíæ Space Complexity
            </div>
            <div class="complexity-value" style="color: #ff9800">O(n)</div>
            <p
              style="
                font-family: 'Patrick Hand', cursive;
                font-size: 16px;
                margin-top: 10px;
              "
            >
              ‚ö†Ô∏è Call stack stores n frames!<br />
              (May cause stack overflow for large lists)
            </p>
          </div>
        </div>
      </div>

      <!-- Summary -->
      <div
        class="key-insight"
        style="
          margin-top: 40px;
          background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
          border-color: #9c27b0;
        "
      >
        <div class="key-insight-title" style="color: #6a1b9a">
          üìö Summary: How Recursion Works Here
        </div>
        <div class="key-insight-text">
          <strong>Phase 1 - Dive Down:</strong><br />
          ‚Ä¢ Keep calling reverseList(head.next) until we hit the last node<br />
          ‚Ä¢ Each call waits on the stack for its child to return<br />
          ‚Ä¢ No actual reversing happens yet!<br /><br />

          <strong>Phase 2 - Bubble Up:</strong><br />
          ‚Ä¢ Base case returns the last node (becomes newHead)<br />
          ‚Ä¢ As each call resumes, it does 2 things:<br />
          &nbsp;&nbsp;1. <code>head.next.next = head</code> ‚Äî make next node
          point back<br />
          &nbsp;&nbsp;2. <code>head.next = null</code> ‚Äî break old forward
          link<br />
          ‚Ä¢ newHead (Node 5) is passed all the way back unchanged!<br /><br />

          <strong>Trade-off vs Iterative:</strong><br />
          ‚úÖ More elegant, easier to understand conceptually<br />
          ‚ùå Uses O(n) space for call stack (iterative uses O(1))
        </div>
      </div>

      <!-- Comparison with iterative -->
      <div
        class="visualization"
        style="
          margin-top: 30px;
          background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
          border-color: #5c6bc0;
        "
      >
        <div
          style="
            text-align: center;
            font-size: 24px;
            margin-bottom: 15px;
            color: #3949ab;
          "
        >
          ‚öñÔ∏è Recursive vs Iterative
        </div>
        <table
          style="
            width: 100%;
            font-family: 'Patrick Hand', cursive;
            font-size: 18px;
            border-collapse: collapse;
          "
        >
          <tr>
            <th style="padding: 12px; border-bottom: 2px solid #7986cb"></th>
            <th
              style="
                padding: 12px;
                border-bottom: 2px solid #7986cb;
                color: #9c27b0;
              "
            >
              Recursive
            </th>
            <th
              style="
                padding: 12px;
                border-bottom: 2px solid #7986cb;
                color: #1976d2;
              "
            >
              Iterative
            </th>
          </tr>
          <tr>
            <td style="padding: 10px">Time</td>
            <td style="padding: 10px; text-align: center">O(n)</td>
            <td style="padding: 10px; text-align: center">O(n)</td>
          </tr>
          <tr>
            <td style="padding: 10px">Space</td>
            <td style="padding: 10px; text-align: center; color: #f57c00">
              O(n) ‚ö†Ô∏è
            </td>
            <td style="padding: 10px; text-align: center; color: #4caf50">
              O(1) ‚úì
            </td>
          </tr>
          <tr>
            <td style="padding: 10px">Stack Overflow Risk?</td>
            <td style="padding: 10px; text-align: center; color: #f57c00">
              Yes (large lists)
            </td>
            <td style="padding: 10px; text-align: center; color: #4caf50">
              No
            </td>
          </tr>
          <tr>
            <td style="padding: 10px">Code Elegance</td>
            <td style="padding: 10px; text-align: center; color: #4caf50">
              More elegant ‚úì
            </td>
            <td style="padding: 10px; text-align: center">Straightforward</td>
          </tr>
          <tr>
            <td style="padding: 10px">Best For</td>
            <td style="padding: 10px; text-align: center">
              Interviews, small lists
            </td>
            <td style="padding: 10px; text-align: center">Production code</td>
          </tr>
        </table>
      </div>
    </div>
  </body>
</html>
